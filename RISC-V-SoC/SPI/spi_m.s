(TpProg (TpModule (TpTask spiMaster (sharp null) (paras (Port (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_reset (TpDim null) NullExp) (TpVarTp i_clk (TpDim null) NullExp) (TpVarTp i_tx_data (TpDim null) NullExp) (TpVarTp i_tx_valid (TpDim null) NullExp) (TpVarTp o_tx_ready (TpDim null) NullExp) (TpVarTp o_rx_valid (TpDim null) NullExp) (TpVarTp o_rx_data (TpDim null) NullExp) (TpVarTp o_spi_clk (TpDim null) NullExp) (TpVarTp i_spi_MISO (TpDim null) NullExp) (TpVarTp o_spi_MOSI (TpDim null) NullExp))))) (parameters null) (localparam null) (ilists (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_reset (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_clk (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Sub (Atom (Sym (Var DATAWIDTH))) (Atom (Int 1))) (Atom (Int 0))) (sharp (TpVarTp i_tx_data (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_tx_valid (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_spi_MISO (TpDim null) NullExp)))) (iolists null) (olists (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_tx_ready (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_rx_valid (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Sub (Atom (Sym (Var DATAWIDTH))) (Atom (Int 1))) (Atom (Int 0))) (sharp (TpVarTp o_rx_data (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_spi_clk (TpDim null) NullExp))) (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_spi_MOSI (TpDim null) NullExp)))) (sigset (Parameter (SignRng (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp DATAWIDTH (TpDim null) (Atom (Int 8))))))) (Parameter (SignRng (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp SPI_MODE (TpDim null) (Atom (Int 0))))))) (Parameter (SignRng (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp CLKS_PER_HALF_BIT (TpDim null) (Atom (Int 2))))))) (Input Nwire (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_reset (TpDim null) NullExp)))) (Input Nwire (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_clk (TpDim null) NullExp)))) (Input Nwire (TpSigDeclBody false NoDelay (RngC (Sub (Atom (Sym (Var DATAWIDTH))) (Atom (Int 1))) (Atom (Int 0))) (sharp (TpVarTp i_tx_data (TpDim null) NullExp)))) (Input Nwire (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_tx_valid (TpDim null) NullExp)))) (Output Regtype (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_tx_ready (TpDim null) NullExp)))) (Output Regtype (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_rx_valid (TpDim null) NullExp)))) (Output Regtype (TpSigDeclBody false NoDelay (RngC (Sub (Atom (Sym (Var DATAWIDTH))) (Atom (Int 1))) (Atom (Int 0))) (sharp (TpVarTp o_rx_data (TpDim null) NullExp)))) (Output Regtype (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_spi_clk (TpDim null) NullExp)))) (Input Nwire (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp i_spi_MISO (TpDim null) NullExp)))) (Output Regtype (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp o_spi_MOSI (TpDim null) NullExp)))) (Wire (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp w_CPOL (TpDim null) NullExp)))) (Wire (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp w_CPHA (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Sub (Funcall (SimpFunCall (Sfname Clog2) (TpParaList (Pexp (Mul (Atom (Sym (Var CLKS_PER_HALF_BIT))) (Atom (Int 2))))))) (Atom (Int 1))) (Atom (Int 0))) (sharp (TpVarTp r_spi_clk_count (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp r_spi_clk (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 4)) (Atom (Int 0))) (sharp (TpVarTp r_spi_clk_edges (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp r_leading_edge (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp r_trailing_edge (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 0)) (Atom (Int 0))) (sharp (TpVarTp r_tx_valid (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Sub (Atom (Sym (Var DATAWIDTH))) (Atom (Int 1))) (Atom (Int 0))) (sharp (TpVarTp r_tx_data (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 2)) (Atom (Int 0))) (sharp (TpVarTp r_tx_bit_count (TpDim null) NullExp)))) (Reg (TpSigDeclBody false NoDelay (RngC (Atom (Int 2)) (Atom (Int 0))) (sharp (TpVarTp r_rx_bit_count (TpDim null) NullExp))))) (body (Assign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var w_CPOL)) (BitOr (Eq (Atom (Sym (Var SPI_MODE))) (Atom (Int 2))) (Eq (Atom (Sym (Var SPI_MODE))) (Atom (Int 3)))) NoDE)))) (Assign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var w_CPHA)) (BitOr (Eq (Atom (Sym (Var SPI_MODE))) (Atom (Int 1))) (Eq (Atom (Sym (Var SPI_MODE))) (Atom (Int 3)))) NoDE)))) (Always (TpEvent (Posedge (TpVarRange i_clk Rng0))) (body (Block null (body (If (Atom (Sym (Var i_reset))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_tx_ready)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_edges)) (Atom (Num false 5 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_leading_edge)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_trailing_edge)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk)) (Atom (Sym (Var w_CPOL))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_count)) (Atom (Int 0)) NoDE)))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_leading_edge)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_trailing_edge)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (If (Atom (Sym (Var i_tx_valid))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_tx_ready)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_edges)) (Atom (Int 16)) NoDE)))))) (If (Gt (Atom (Sym (Var r_spi_clk_edges))) (Atom (Int 0))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_tx_ready)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_edges)) (Sub (Atom (Sym (Var r_spi_clk_edges))) (Atom (Int 1))) NoDE)))) (If (Eq (Atom (Sym (Var r_spi_clk_count))) (Sub (Mul (Atom (Sym (Var CLKS_PER_HALF_BIT))) (Atom (Int 2))) (Atom (Int 1)))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_trailing_edge)) (Atom (Int 1)) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_count)) (Atom (Int 0)) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk)) (Not (Atom (Sym (Var r_spi_clk)))) NoDE)))))) (If (Eq (Atom (Sym (Var r_spi_clk_count))) (Sub (Atom (Sym (Var CLKS_PER_HALF_BIT))) (Atom (Int 1)))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_leading_edge)) (Atom (Num false 1 (Bin false 1))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_count)) (Add (Atom (Sym (Var r_spi_clk_count))) (Atom (Int 1))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk)) (Not (Atom (Sym (Var r_spi_clk)))) NoDE)))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_spi_clk_count)) (Add (Atom (Sym (Var r_spi_clk_count))) (Atom (Int 1))) NoDE)))))))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_tx_ready)) (Atom (Int 1)) NoDE))))))))))))))) (Always (TpEvent (Posedge (TpVarRange i_clk Rng0))) (body (Block null (body (If (Atom (Sym (Var i_reset))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_data)) (Atom (Num false 8 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_valid)) (Atom (Num false 1 (Bin false 0))) NoDE)))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_valid)) (Atom (Sym (Var i_tx_valid))) NoDE)))) (If (Atom (Sym (Var i_tx_valid))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_data)) (Atom (Sym (Var i_tx_data))) NoDE)))))) NoElse)))))))) (Always (TpEvent (Posedge (TpVarRange i_clk Rng0))) (body (Block null (body (If (Atom (Sym (Var i_reset))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_spi_MOSI)) (Atom (Num false 1 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_bit_count)) (Atom (Num false 3 (Bin false 111))) NoDE)))))) (Block null (body (If (Atom (Sym (Var o_tx_ready))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_bit_count)) (Atom (Num false 3 (Bin false 111))) NoDE)))) (If (BitAnd (Atom (Sym (Var r_tx_valid))) (Not (Atom (Sym (Var w_CPHA))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_spi_MOSI)) (Atom (Sym (Idx r_tx_data (TpExpList (Atom (Int 7))) Rng0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_bit_count)) (Atom (Num false 3 (Bin false 110))) NoDE)))))) (If (BitOr (BitAnd (Atom (Sym (Var r_leading_edge))) (Atom (Sym (Var w_CPHA)))) (BitAnd (Atom (Sym (Var r_trailing_edge))) (Not (Atom (Sym (Var w_CPHA)))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_tx_bit_count)) (Sub (Atom (Sym (Var r_tx_bit_count))) (Atom (Int 1))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_spi_MOSI)) (Atom (Sym (Idx r_tx_data (TpExpList (Atom (Sym (Var r_tx_bit_count)))) Rng0))) NoDE)))))) NoElse)))))))))) (Always (TpEvent (Posedge (TpVarRange i_clk Rng0))) (body (Block null (body (If (Atom (Sym (Var i_reset))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_rx_data)) (Atom (Num false 8 (Bin false 0))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_rx_valid)) (Atom (Int 0)) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_rx_bit_count)) (Atom (Num false 3 (Bin false 111))) NoDE)))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_rx_valid)) (Atom (Int 0)) NoDE)))) (If (Atom (Sym (Var o_tx_ready))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_rx_bit_count)) (Atom (Num false 3 (Bin false 111))) NoDE)))))) (If (BitOr (BitAnd (Atom (Sym (Var r_leading_edge))) (Not (Atom (Sym (Var w_CPHA))))) (BitAnd (Atom (Sym (Var r_trailing_edge))) (Atom (Sym (Var w_CPHA))))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Idx o_rx_data (TpExpList (Atom (Sym (Var r_rx_bit_count)))) Rng0)) (Atom (Sym (Var i_spi_MISO))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var r_rx_bit_count)) (Sub (Atom (Sym (Var r_rx_bit_count))) (Atom (Int 1))) NoDE)))) (If (Eq (Atom (Sym (Var r_rx_bit_count))) (Atom (Num false 3 (Bin false 000)))) (Block null (body (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_rx_valid)) (Atom (Int 1)) NoDE)))))) NoElse))) NoElse))))))))) (Always (TpEvent (Posedge (TpVarRange i_clk Rng0))) (body (Block null (body (If (Atom (Sym (Var i_reset))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_spi_clk)) (Atom (Sym (Var w_CPOL))) NoDE)))) (NbkAssign (TpAssign NoDE (TpEqAssigns (TpEqAssign (Lname (Var o_spi_clk)) (Atom (Sym (Var r_spi_clk))) NoDE)))))))))) (macros (DefaultNettype Dnone)))))
